# CLAUDE.local.md - í•™ìŠµ ë‚´ìš© ë° ì¤‘ìš” ê²°ì •ì‚¬í•­

ì´ ë¬¸ì„œëŠ” Claudeì™€ì˜ í˜‘ì—… ê³¼ì •ì—ì„œ í•™ìŠµí•œ ë‚´ìš©ê³¼ ì¤‘ìš”í•œ ì•„í‚¤í…ì²˜ ê²°ì •ì‚¬í•­ì„ ê¸°ë¡í•©ë‹ˆë‹¤.

## ğŸ—ï¸ ì•„í‚¤í…ì²˜ ì„¤ê³„ ê²°ì •ì‚¬í•­

### 1. SOLID ì›ì¹™ ì ìš©
**ê²°ì •**: ì „ì²´ ì•„í‚¤í…ì²˜ì— SOLID ì›ì¹™ì„ ì—„ê²©íˆ ì ìš©
**ì´ìœ **: í™•ì¥ì„±ê³¼ ìœ ì§€ë³´ìˆ˜ì„±ì„ ìœ„í•´ í•„ìˆ˜
**êµ¬í˜„**:
- **S**RP: ê° í´ë˜ìŠ¤ëŠ” ë‹¨ì¼ ì±…ì„ (BaseAPIClient, BaseRepository, BaseService ë¶„ë¦¬)
- **O**CP: ìƒˆë¡œìš´ API ì†ŒìŠ¤ ì¶”ê°€ ì‹œ ê¸°ì¡´ ì½”ë“œ ìˆ˜ì • ì—†ì´ í™•ì¥ (Plugin System)
- **L**SP: ëª¨ë“  êµ¬í˜„ì²´ëŠ” ê¸°ë³¸ ì¸í„°í˜ì´ìŠ¤ë¡œ êµì²´ ê°€ëŠ¥
- **I**SP: í´ë¼ì´ì–¸íŠ¸ë³„ í•„ìš”í•œ ì¸í„°í˜ì´ìŠ¤ë§Œ ì˜ì¡´
- **D**IP: êµ¬ì²´ì  êµ¬í˜„ë³´ë‹¤ ì¶”ìƒí™”ì— ì˜ì¡´ (Factory Pattern)

### 2. ë””ìì¸ íŒ¨í„´ ì¡°í•©
**ì„ íƒí•œ íŒ¨í„´ë“¤ê³¼ ì´ìœ **:

```
Strategy Pattern + Template Method Pattern
â”œâ”€â”€ Strategy: ëŸ°íƒ€ì„ ì•Œê³ ë¦¬ì¦˜ êµì²´ (ì¸ì¦, ìš”ì²­ ì²˜ë¦¬)
â””â”€â”€ Template: ê³µí†µ ì²˜ë¦¬ íë¦„ í‘œì¤€í™” (API í˜¸ì¶œ íŒŒì´í”„ë¼ì¸)

Factory Pattern + Abstract Factory Pattern  
â”œâ”€â”€ Factory: ë‹¨ì¼ ê°ì²´ ìƒì„±
â””â”€â”€ Abstract Factory: ê´€ë ¨ ê°ì²´êµ° ìƒì„± (ì™„ì „í•œ ì„œë¹„ìŠ¤ ìŠ¤íƒ)

Repository Pattern + Unit of Work Pattern
â”œâ”€â”€ Repository: ë°ì´í„° ì ‘ê·¼ ì¶”ìƒí™”
â””â”€â”€ Unit of Work: íŠ¸ëœì­ì…˜ ê´€ë¦¬ (í–¥í›„ êµ¬í˜„)

Plugin Pattern + Registry Pattern
â”œâ”€â”€ Plugin: ë™ì  ê¸°ëŠ¥ í™•ì¥
â””â”€â”€ Registry: í”ŒëŸ¬ê·¸ì¸ ìƒëª…ì£¼ê¸° ê´€ë¦¬
```

### 3. ì œë„¤ë¦­ íƒ€ì… ì‹œìŠ¤í…œ
**ê²°ì •**: TypeVarì™€ Genericì„ ì ê·¹ í™œìš©
**ì¥ì **: ì»´íŒŒì¼ íƒ€ì„ íƒ€ì… ì•ˆì „ì„± + IDE ì§€ì›
**êµ¬í˜„ ì˜ˆì‹œ**:
```python
T = TypeVar('T', bound=BaseModel)
CreateT = TypeVar('CreateT', bound=BaseModel)
UpdateT = TypeVar('UpdateT', bound=BaseModel)

class BaseRepository(ABC, Generic[T, CreateT, UpdateT]):
    # íƒ€ì… ì•ˆì „í•œ CRUD ì‘ì—…
```

## ğŸ”§ ê¸°ìˆ ì  í•™ìŠµ ì‚¬í•­

### 1. MongoDB ObjectId ì²˜ë¦¬ íŒ¨í„´
**ë¬¸ì œ**: Pydanticê³¼ MongoDB _id í•„ë“œ ë¶ˆì¼ì¹˜
**í•´ê²°ì±…**: ì„œë¹„ìŠ¤ ê³„ì¸µì—ì„œ ì¼ê´€ëœ ë³€í™˜
```python
def _convert_objectid_to_string(self, doc: Dict[str, Any]) -> Dict[str, Any]:
    if "_id" in doc:
        doc["id"] = str(doc["_id"])
        del doc["_id"]
    return doc
```

### 2. ë¹„ë™ê¸° vs ë™ê¸° ì „ëµ
**í˜„ì¬ ê²°ì •**: í˜¼í•© ì‚¬ìš©
- **ë™ê¸°**: pymongo (ë°ì´í„°ë² ì´ìŠ¤), ë‹¨ìˆœ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
- **ë¹„ë™ê¸°**: httpx (ì™¸ë¶€ API), I/O ì§‘ì•½ì  ì‘ì—…
**í–¥í›„**: í•„ìš” ì‹œ Motorë¡œ ì™„ì „ ë¹„ë™ê¸° ì „í™˜

### 3. ì—ëŸ¬ ì²˜ë¦¬ ê³„ì¸µí™”
```
Application Level (FastAPI)
â”œâ”€â”€ HTTP ìƒíƒœ ì½”ë“œ ë§¤í•‘
â”œâ”€â”€ ì‚¬ìš©ì ì¹œí™”ì  ë©”ì‹œì§€
â””â”€â”€ ë¡œê¹… ë° ëª¨ë‹ˆí„°ë§

Service Level
â”œâ”€â”€ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ê²€ì¦
â”œâ”€â”€ ë„ë©”ì¸ ì˜ˆì™¸ ì²˜ë¦¬  
â””â”€â”€ íŠ¸ëœì­ì…˜ ë¡¤ë°±

Repository Level
â”œâ”€â”€ ë°ì´í„° ì ‘ê·¼ ì˜¤ë¥˜
â”œâ”€â”€ ì œì•½ ì¡°ê±´ ìœ„ë°˜
â””â”€â”€ ì—°ê²° ì˜¤ë¥˜

External API Level
â”œâ”€â”€ ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜
â”œâ”€â”€ ì¸ì¦ ì‹¤íŒ¨
â””â”€â”€ Rate Limiting
```

## ğŸ¯ ì•„í‚¤í…ì²˜ í•µì‹¬ ì›ì¹™

### 1. í™•ì¥ì„± ìš°ì„  ì„¤ê³„
- ìƒˆë¡œìš´ ê³µê³µë°ì´í„° API ì¶”ê°€ê°€ ì£¼ìš” ìš”êµ¬ì‚¬í•­
- Plugin Systemìœ¼ë¡œ ëŸ°íƒ€ì„ í™•ì¥ ì§€ì›
- Factory Patternìœ¼ë¡œ ê°ì²´ ìƒì„± ì¶”ìƒí™”

### 2. ê³„ì¸µ ë¶„ë¦¬ ì›ì¹™
```
Presentation Layer (FastAPI Routers)
â”œâ”€â”€ HTTP ìš”ì²­/ì‘ë‹µ ì²˜ë¦¬
â”œâ”€â”€ ì…ë ¥ ê²€ì¦
â””â”€â”€ ì¸ì¦/ì¸ê°€

Business Layer (Services)  
â”œâ”€â”€ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
â”œâ”€â”€ ë°ì´í„° ë³€í™˜
â””â”€â”€ ì™¸ë¶€ API í†µí•©

Data Access Layer (Repositories)
â”œâ”€â”€ ë°ì´í„° ì €ì¥/ì¡°íšŒ
â”œâ”€â”€ ì¿¼ë¦¬ ìµœì í™”
â””â”€â”€ íŠ¸ëœì­ì…˜ ê´€ë¦¬

Infrastructure Layer (Clients, Config)
â”œâ”€â”€ ì™¸ë¶€ ì‹œìŠ¤í…œ ì—°ë™
â”œâ”€â”€ ì„¤ì • ê´€ë¦¬
â””â”€â”€ ìœ í‹¸ë¦¬í‹° ê¸°ëŠ¥
```

### 3. ì˜ì¡´ì„± ì—­ì „ ì‹¤í˜„
- ì¸í„°í˜ì´ìŠ¤ì— ì˜ì¡´, êµ¬í˜„ì— ì˜ì¡´í•˜ì§€ ì•ŠìŒ
- í…ŒìŠ¤íŠ¸ ê°€ëŠ¥ì„± ê·¹ëŒ€í™”
- ëª¨ë“ˆ ê°„ ê²°í•©ë„ ìµœì†Œí™”

## ğŸ“š êµ¬í˜„í•œ í•µì‹¬ ì»´í¬ë„ŒíŠ¸

### 1. BaseAPIClient - Template Method Pattern
```python
def request() -> APIResponse[T]:
    # 1. ì…ë ¥ ê²€ì¦
    # 2. ì „ì²˜ë¦¬ (Strategy ì ìš©)
    # 3. ì¸ì¦ (Strategy ì ìš©)  
    # 4. HTTP í˜¸ì¶œ (ì¬ì‹œë„ ë¡œì§)
    # 5. í›„ì²˜ë¦¬ (Hook Method)
    # 6. ë³€í™˜ (ì¶”ìƒ ë©”ì„œë“œ)
```

### 2. BaseRepository - Repository Pattern
```python
class BaseRepository(Generic[T, CreateT, UpdateT]):
    # CRUD ê¸°ë³¸ ì‘ì—…
    # ì¿¼ë¦¬ ë¹Œë” (QueryFilter, SortOption)
    # í˜ì´ì§€ë„¤ì´ì…˜ ì§€ì›
    # ë°°ì¹˜ ì‘ì—… ì§€ì›
```

### 3. BaseService - Service Layer Pattern
```python  
class BaseService(Generic[T, CreateT, UpdateT, ResponseT]):
    # ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ìº¡ìŠí™”
    # ë°ì´í„° ë³€í™˜ (ë„ë©”ì¸ â†” DTO)
    # ì™¸ë¶€ API í†µí•©
    # Hook ë©”ì„œë“œ (before/after)
```

### 4. Plugin Registry - Plugin Pattern
```python
class PluginRegistry:
    # ë™ì  í”ŒëŸ¬ê·¸ì¸ ë“±ë¡/í•´ì œ
    # ì˜ì¡´ì„± ê´€ë¦¬
    # ìƒëª…ì£¼ê¸° ê´€ë¦¬
    # ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ê²©ë¦¬
```

## ğŸš€ ë‹¤ìŒ êµ¬í˜„ ìš°ì„ ìˆœìœ„

### ë‹¨ê¸° (1-2ì£¼)
1. **K-Startup API í´ë¼ì´ì–¸íŠ¸ ë¦¬íŒ©í† ë§**
   - BaseAPIClient ìƒì† êµ¬ì¡°ë¡œ ë³€ê²½
   - ë¹„ë™ê¸° HTTP í´ë¼ì´ì–¸íŠ¸ ì ìš©
   - ê°•í™”ëœ ì—ëŸ¬ ì²˜ë¦¬ ë° ì¬ì‹œë„

### ì¤‘ê¸° (1ê°œì›”)
2. **Repository íŒ¨í„´ ì „ë©´ ì ìš©**
   - ëª¨ë“  ë„ë©”ì¸ì— BaseRepository ì ìš©
   - ì¿¼ë¦¬ ìµœì í™” ë° ì¸ë±ìŠ¤ ì„¤ê³„
   - íŠ¸ëœì­ì…˜ ê´€ë¦¬ êµ¬í˜„

3. **ë‚˜ë¨¸ì§€ ë„ë©”ì¸ ì™„ì„±**
   - contents, statistics, businesses ë„ë©”ì¸
   - ë„ë©”ì¸ë³„ íŠ¹í™” ë¡œì§ êµ¬í˜„
   - í†µí•© í…ŒìŠ¤íŠ¸ ì‘ì„±

### ì¥ê¸° (2-3ê°œì›”)
4. **ê³ ê¸‰ ê¸°ëŠ¥ êµ¬í˜„**
   - í†µí•© ê²€ìƒ‰ (Elasticsearch ì—°ë™)
   - ì‹¤ì‹œê°„ ì•Œë¦¼ (WebSocket)
   - ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§ (Prometheus + Grafana)

## ğŸ’¡ í•µì‹¬ í•™ìŠµ í¬ì¸íŠ¸

### 1. ì¶”ìƒí™”ì˜ ì ì ˆí•œ ìˆ˜ì¤€
- ë„ˆë¬´ ì¶”ìƒì : ë³µì¡ì„± ì¦ê°€, ì´í•´í•˜ê¸° ì–´ë ¤ì›€
- ë„ˆë¬´ êµ¬ì²´ì : í™•ì¥ì„± ì €í•´, ì¤‘ë³µ ì½”ë“œ ë°œìƒ
- **ê· í˜•ì **: í˜„ì¬ ìš”êµ¬ì‚¬í•­ + ì˜ˆìƒ ê°€ëŠ¥í•œ í™•ì¥ ê³ ë ¤

### 2. íƒ€ì… ì‹œìŠ¤í…œ í™œìš©
- Pythonì˜ íƒ€ì… íŒíŠ¸ë¥¼ ì ê·¹ í™œìš©
- ì œë„¤ë¦­ìœ¼ë¡œ ì¬ì‚¬ìš©ì„± ê·¹ëŒ€í™”
- mypy ë“± ì •ì  ë¶„ì„ ë„êµ¬ í™œìš© í•„ìˆ˜

### 3. í…ŒìŠ¤íŠ¸ ê°€ëŠ¥í•œ ì„¤ê³„
- ì˜ì¡´ì„± ì£¼ì…ìœ¼ë¡œ Mock ê°€ëŠ¥í•œ êµ¬ì¡°
- ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ì™€ í†µí•© í…ŒìŠ¤íŠ¸ ë¶„ë¦¬
- í…ŒìŠ¤íŠ¸ ë”ë¸”(Mock, Stub, Fake) ì ì ˆíˆ í™œìš©

## ğŸ” ëª¨ë‹ˆí„°ë§ ë° ë©”íŠ¸ë¦­

### ê°œë°œ ì§„í–‰ ìƒí™©
- [x] Task 1: ê³µí†µ ì¸í„°í˜ì´ìŠ¤ ë° ì¶”ìƒí™” ê³„ì¸µ ì„¤ê³„ (ì™„ë£Œ)
- [ ] Task 2: K-Startup API í´ë¼ì´ì–¸íŠ¸ ë¦¬íŒ©í† ë§ (ë‹¤ìŒ)
- [ ] Task 3: Repository íŒ¨í„´ ì ìš©
- [ ] Task 4: ì˜ì¡´ì„± ì£¼ì… ì‹œìŠ¤í…œ êµ¬ì¶•
- [ ] Task 5: ë°ì´í„° ì†ŒìŠ¤ ê´€ë¦¬ ì‹œìŠ¤í…œ

### ì½”ë“œ í’ˆì§ˆ ë©”íŠ¸ë¦­ (ëª©í‘œ)
- í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€: >80%
- íƒ€ì… ì»¤ë²„ë¦¬ì§€: >90%
- ë³µì¡ë„: Cyclomatic complexity < 10
- ì¤‘ë³µë„: DRY ì›ì¹™ ì¤€ìˆ˜

## ğŸ¤– ì‘ì—… ëª¨ë‹ˆí„°ë§ ê°€ì´ë“œ

### ì‘ì—… ì™„ë£Œ í›„ í™•ì¸ ì‚¬í•­
- ì‘ì—…ì´ ëë‚˜ë©´, task-master ì˜ ì„œë¸ŒíƒœìŠ¤í¬ì™€, ê° íƒœìŠ¤í¬ë¥¼ í™•ì¸í•œë‹¤.

---

*ì´ ë¬¸ì„œëŠ” í”„ë¡œì íŠ¸ ì§„í–‰ì— ë”°ë¼ ì§€ì†ì ìœ¼ë¡œ ì—…ë°ì´íŠ¸ë©ë‹ˆë‹¤.*
*ìƒˆë¡œìš´ ì•„í‚¤í…ì²˜ ê²°ì •ì´ë‚˜ í•™ìŠµ ì‚¬í•­ì´ ìˆì„ ë•Œë§ˆë‹¤ ê¸°ë¡í•´ì£¼ì„¸ìš”.*